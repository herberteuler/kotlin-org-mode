/*
 * This Kotlin source file was generated by the Gradle 'init' task.
 */
package orgmode

import java.io.File
import orgmode.parser.*

var timer: Long = System.nanoTime()

fun tic() {
    timer = System.nanoTime()
}

fun toc(msg: String) {
    println("$msg in ${(System.nanoTime() - timer) / 1000000} ms")
}

fun main(args: Array<String>) {

    var org: Org

    if (args.size > 0) {
        tic()
        org = RegexOrgParser(FileSource(args[0])).parse()
        toc("File parsed")
    } else {

        org = RegexOrgParser(
            StringSource(
                """
* DONE Test blocks [1/2] [44%]
CLOSED: [2020-02-02 Thue +1w]
:PROPERTIES:
:TAG: Test
:END:
#+BEGIN_SRC
test
code
#+END_SRC

1. [ ] Test
2. [X] List
3. Checkboxes
4. [ ]
"""
            )
        ).parse()
    }

    if(args.size == 0) {
        println(org.toString())
        println(org.toJson())
    }
    if(args.size == 2) {
        tic()
        File(args[1]).writeText(org.toHtml())
        toc("Html generated")
    }
    if(args.size == 1) {
        File("README.html").writeText(org.toHtml())
        File("README.md").writeText(org.toMarkdown())
    }
    // println(org.toString())
    // println(org.toJson())
}
